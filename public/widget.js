var Co=Object.defineProperty;var Io=(G,j,oe)=>j in G?Co(G,j,{enumerable:!0,configurable:!0,writable:!0,value:oe}):G[j]=oe;var w=(G,j,oe)=>Io(G,typeof j!="symbol"?j+"":j,oe);(function(){"use strict";/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var yn,os;const G=globalThis,j=G.ShadowRoot&&(G.ShadyCSS===void 0||G.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,oe=Symbol(),As=new WeakMap;let Ss=class{constructor(e,t,n){if(this._$cssResult$=!0,n!==oe)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(j&&e===void 0){const n=t!==void 0&&t.length===1;n&&(e=As.get(t)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),n&&As.set(t,e))}return e}toString(){return this.cssText}};const Vn=s=>new Ss(typeof s=="string"?s:s+"",void 0,oe),Y=(s,...e)=>{const t=s.length===1?s[0]:e.reduce((n,r,i)=>n+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(r)+s[i+1],s[0]);return new Ss(t,s,oe)},Zn=(s,e)=>{if(j)s.adoptedStyleSheets=e.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet);else for(const t of e){const n=document.createElement("style"),r=G.litNonce;r!==void 0&&n.setAttribute("nonce",r),n.textContent=t.cssText,s.appendChild(n)}},$s=j?s=>s:s=>s instanceof CSSStyleSheet?(e=>{let t="";for(const n of e.cssRules)t+=n.cssText;return Vn(t)})(s):s;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:Yn,defineProperty:Xn,getOwnPropertyDescriptor:Kn,getOwnPropertyNames:Qn,getOwnPropertySymbols:Jn,getPrototypeOf:er}=Object,ae=globalThis,Ts=ae.trustedTypes,tr=Ts?Ts.emptyScript:"",Ot=ae.reactiveElementPolyfillSupport,Ue=(s,e)=>s,rt={toAttribute(s,e){switch(e){case Boolean:s=s?tr:null;break;case Object:case Array:s=s==null?s:JSON.stringify(s)}return s},fromAttribute(s,e){let t=s;switch(e){case Boolean:t=s!==null;break;case Number:t=s===null?null:Number(s);break;case Object:case Array:try{t=JSON.parse(s)}catch{t=null}}return t}},Pt=(s,e)=>!Yn(s,e),Es={attribute:!0,type:String,converter:rt,reflect:!1,useDefault:!1,hasChanged:Pt};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),ae.litPropertyMetadata??(ae.litPropertyMetadata=new WeakMap);let $e=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??(this.l=[])).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=Es){if(t.state&&(t.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((t=Object.create(t)).wrapped=!0),this.elementProperties.set(e,t),!t.noAccessor){const n=Symbol(),r=this.getPropertyDescriptor(e,n,t);r!==void 0&&Xn(this.prototype,e,r)}}static getPropertyDescriptor(e,t,n){const{get:r,set:i}=Kn(this.prototype,e)??{get(){return this[t]},set(o){this[t]=o}};return{get:r,set(o){const l=r==null?void 0:r.call(this);i==null||i.call(this,o),this.requestUpdate(e,l,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??Es}static _$Ei(){if(this.hasOwnProperty(Ue("elementProperties")))return;const e=er(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(Ue("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(Ue("properties"))){const t=this.properties,n=[...Qn(t),...Jn(t)];for(const r of n)this.createProperty(r,t[r])}const e=this[Symbol.metadata];if(e!==null){const t=litPropertyMetadata.get(e);if(t!==void 0)for(const[n,r]of t)this.elementProperties.set(n,r)}this._$Eh=new Map;for(const[t,n]of this.elementProperties){const r=this._$Eu(t,n);r!==void 0&&this._$Eh.set(r,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const n=new Set(e.flat(1/0).reverse());for(const r of n)t.unshift($s(r))}else e!==void 0&&t.push($s(e));return t}static _$Eu(e,t){const n=t.attribute;return n===!1?void 0:typeof n=="string"?n:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var e;this._$ES=new Promise(t=>this.enableUpdating=t),this._$AL=new Map,this._$E_(),this.requestUpdate(),(e=this.constructor.l)==null||e.forEach(t=>t(this))}addController(e){var t;(this._$EO??(this._$EO=new Set)).add(e),this.renderRoot!==void 0&&this.isConnected&&((t=e.hostConnected)==null||t.call(e))}removeController(e){var t;(t=this._$EO)==null||t.delete(e)}_$E_(){const e=new Map,t=this.constructor.elementProperties;for(const n of t.keys())this.hasOwnProperty(n)&&(e.set(n,this[n]),delete this[n]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return Zn(e,this.constructor.elementStyles),e}connectedCallback(){var e;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$EO)==null||e.forEach(t=>{var n;return(n=t.hostConnected)==null?void 0:n.call(t)})}enableUpdating(e){}disconnectedCallback(){var e;(e=this._$EO)==null||e.forEach(t=>{var n;return(n=t.hostDisconnected)==null?void 0:n.call(t)})}attributeChangedCallback(e,t,n){this._$AK(e,n)}_$ET(e,t){var i;const n=this.constructor.elementProperties.get(e),r=this.constructor._$Eu(e,n);if(r!==void 0&&n.reflect===!0){const o=(((i=n.converter)==null?void 0:i.toAttribute)!==void 0?n.converter:rt).toAttribute(t,n.type);this._$Em=e,o==null?this.removeAttribute(r):this.setAttribute(r,o),this._$Em=null}}_$AK(e,t){var i,o;const n=this.constructor,r=n._$Eh.get(e);if(r!==void 0&&this._$Em!==r){const l=n.getPropertyOptions(r),c=typeof l.converter=="function"?{fromAttribute:l.converter}:((i=l.converter)==null?void 0:i.fromAttribute)!==void 0?l.converter:rt;this._$Em=r;const h=c.fromAttribute(t,l.type);this[r]=h??((o=this._$Ej)==null?void 0:o.get(r))??h,this._$Em=null}}requestUpdate(e,t,n){var r;if(e!==void 0){const i=this.constructor,o=this[e];if(n??(n=i.getPropertyOptions(e)),!((n.hasChanged??Pt)(o,t)||n.useDefault&&n.reflect&&o===((r=this._$Ej)==null?void 0:r.get(e))&&!this.hasAttribute(i._$Eu(e,n))))return;this.C(e,t,n)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,t,{useDefault:n,reflect:r,wrapped:i},o){n&&!(this._$Ej??(this._$Ej=new Map)).has(e)&&(this._$Ej.set(e,o??t??this[e]),i!==!0||o!==void 0)||(this._$AL.has(e)||(this.hasUpdated||n||(t=void 0),this._$AL.set(e,t)),r===!0&&this._$Em!==e&&(this._$Eq??(this._$Eq=new Set)).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var n;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[i,o]of this._$Ep)this[i]=o;this._$Ep=void 0}const r=this.constructor.elementProperties;if(r.size>0)for(const[i,o]of r){const{wrapped:l}=o,c=this[i];l!==!0||this._$AL.has(i)||c===void 0||this.C(i,void 0,o,c)}}let e=!1;const t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),(n=this._$EO)==null||n.forEach(r=>{var i;return(i=r.hostUpdate)==null?void 0:i.call(r)}),this.update(t)):this._$EM()}catch(r){throw e=!1,this._$EM(),r}e&&this._$AE(t)}willUpdate(e){}_$AE(e){var t;(t=this._$EO)==null||t.forEach(n=>{var r;return(r=n.hostUpdated)==null?void 0:r.call(n)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&(this._$Eq=this._$Eq.forEach(t=>this._$ET(t,this[t]))),this._$EM()}updated(e){}firstUpdated(e){}};$e.elementStyles=[],$e.shadowRootOptions={mode:"open"},$e[Ue("elementProperties")]=new Map,$e[Ue("finalized")]=new Map,Ot==null||Ot({ReactiveElement:$e}),(ae.reactiveElementVersions??(ae.reactiveElementVersions=[])).push("2.1.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const He=globalThis,it=He.trustedTypes,vs=it?it.createPolicy("lit-html",{createHTML:s=>s}):void 0,Rs="$lit$",le=`lit$${Math.random().toFixed(9).slice(2)}$`,Cs="?"+le,sr=`<${Cs}>`,he=document,Be=()=>he.createComment(""),qe=s=>s===null||typeof s!="object"&&typeof s!="function",Lt=Array.isArray,nr=s=>Lt(s)||typeof(s==null?void 0:s[Symbol.iterator])=="function",Dt=`[ 	
\f\r]`,Fe=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Is=/-->/g,Os=/>/g,pe=RegExp(`>|${Dt}(?:([^\\s"'>=/]+)(${Dt}*=${Dt}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),Ps=/'/g,Ls=/"/g,Ds=/^(?:script|style|textarea|title)$/i,rr=s=>(e,...t)=>({_$litType$:s,strings:e,values:t}),O=rr(1),ue=Symbol.for("lit-noChange"),$=Symbol.for("lit-nothing"),Ms=new WeakMap,de=he.createTreeWalker(he,129);function Ns(s,e){if(!Lt(s)||!s.hasOwnProperty("raw"))throw Error("invalid template strings array");return vs!==void 0?vs.createHTML(e):e}const ir=(s,e)=>{const t=s.length-1,n=[];let r,i=e===2?"<svg>":e===3?"<math>":"",o=Fe;for(let l=0;l<t;l++){const c=s[l];let h,p,g=-1,d=0;for(;d<c.length&&(o.lastIndex=d,p=o.exec(c),p!==null);)d=o.lastIndex,o===Fe?p[1]==="!--"?o=Is:p[1]!==void 0?o=Os:p[2]!==void 0?(Ds.test(p[2])&&(r=RegExp("</"+p[2],"g")),o=pe):p[3]!==void 0&&(o=pe):o===pe?p[0]===">"?(o=r??Fe,g=-1):p[1]===void 0?g=-2:(g=o.lastIndex-p[2].length,h=p[1],o=p[3]===void 0?pe:p[3]==='"'?Ls:Ps):o===Ls||o===Ps?o=pe:o===Is||o===Os?o=Fe:(o=pe,r=void 0);const y=o===pe&&s[l+1].startsWith("/>")?" ":"";i+=o===Fe?c+sr:g>=0?(n.push(h),c.slice(0,g)+Rs+c.slice(g)+le+y):c+le+(g===-2?l:y)}return[Ns(s,i+(s[t]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),n]};let Mt=class Wn{constructor({strings:e,_$litType$:t},n){let r;this.parts=[];let i=0,o=0;const l=e.length-1,c=this.parts,[h,p]=ir(e,t);if(this.el=Wn.createElement(h,n),de.currentNode=this.el.content,t===2||t===3){const g=this.el.content.firstChild;g.replaceWith(...g.childNodes)}for(;(r=de.nextNode())!==null&&c.length<l;){if(r.nodeType===1){if(r.hasAttributes())for(const g of r.getAttributeNames())if(g.endsWith(Rs)){const d=p[o++],y=r.getAttribute(g).split(le),_=/([.?@])?(.*)/.exec(d);c.push({type:1,index:i,name:_[2],strings:y,ctor:_[1]==="."?ar:_[1]==="?"?lr:_[1]==="@"?cr:ot}),r.removeAttribute(g)}else g.startsWith(le)&&(c.push({type:6,index:i}),r.removeAttribute(g));if(Ds.test(r.tagName)){const g=r.textContent.split(le),d=g.length-1;if(d>0){r.textContent=it?it.emptyScript:"";for(let y=0;y<d;y++)r.append(g[y],Be()),de.nextNode(),c.push({type:2,index:++i});r.append(g[d],Be())}}}else if(r.nodeType===8)if(r.data===Cs)c.push({type:2,index:i});else{let g=-1;for(;(g=r.data.indexOf(le,g+1))!==-1;)c.push({type:7,index:i}),g+=le.length-1}i++}}static createElement(e,t){const n=he.createElement("template");return n.innerHTML=e,n}};function Te(s,e,t=s,n){var o,l;if(e===ue)return e;let r=n!==void 0?(o=t._$Co)==null?void 0:o[n]:t._$Cl;const i=qe(e)?void 0:e._$litDirective$;return(r==null?void 0:r.constructor)!==i&&((l=r==null?void 0:r._$AO)==null||l.call(r,!1),i===void 0?r=void 0:(r=new i(s),r._$AT(s,t,n)),n!==void 0?(t._$Co??(t._$Co=[]))[n]=r:t._$Cl=r),r!==void 0&&(e=Te(s,r._$AS(s,e.values),r,n)),e}let or=class{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:n}=this._$AD,r=((e==null?void 0:e.creationScope)??he).importNode(t,!0);de.currentNode=r;let i=de.nextNode(),o=0,l=0,c=n[0];for(;c!==void 0;){if(o===c.index){let h;c.type===2?h=new Nt(i,i.nextSibling,this,e):c.type===1?h=new c.ctor(i,c.name,c.strings,this,e):c.type===6&&(h=new hr(i,this,e)),this._$AV.push(h),c=n[++l]}o!==(c==null?void 0:c.index)&&(i=de.nextNode(),o++)}return de.currentNode=he,r}p(e){let t=0;for(const n of this._$AV)n!==void 0&&(n.strings!==void 0?(n._$AI(e,n,t),t+=n.strings.length-2):n._$AI(e[t])),t++}},Nt=class Gn{get _$AU(){var e;return((e=this._$AM)==null?void 0:e._$AU)??this._$Cv}constructor(e,t,n,r){this.type=2,this._$AH=$,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=n,this.options=r,this._$Cv=(r==null?void 0:r.isConnected)??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return t!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=Te(this,e,t),qe(e)?e===$||e==null||e===""?(this._$AH!==$&&this._$AR(),this._$AH=$):e!==this._$AH&&e!==ue&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):nr(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==$&&qe(this._$AH)?this._$AA.nextSibling.data=e:this.T(he.createTextNode(e)),this._$AH=e}$(e){var i;const{values:t,_$litType$:n}=e,r=typeof n=="number"?this._$AC(e):(n.el===void 0&&(n.el=Mt.createElement(Ns(n.h,n.h[0]),this.options)),n);if(((i=this._$AH)==null?void 0:i._$AD)===r)this._$AH.p(t);else{const o=new or(r,this),l=o.u(this.options);o.p(t),this.T(l),this._$AH=o}}_$AC(e){let t=Ms.get(e.strings);return t===void 0&&Ms.set(e.strings,t=new Mt(e)),t}k(e){Lt(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let n,r=0;for(const i of e)r===t.length?t.push(n=new Gn(this.O(Be()),this.O(Be()),this,this.options)):n=t[r],n._$AI(i),r++;r<t.length&&(this._$AR(n&&n._$AB.nextSibling,r),t.length=r)}_$AR(e=this._$AA.nextSibling,t){var n;for((n=this._$AP)==null?void 0:n.call(this,!1,!0,t);e!==this._$AB;){const r=e.nextSibling;e.remove(),e=r}}setConnected(e){var t;this._$AM===void 0&&(this._$Cv=e,(t=this._$AP)==null||t.call(this,e))}},ot=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,n,r,i){this.type=1,this._$AH=$,this._$AN=void 0,this.element=e,this.name=t,this._$AM=r,this.options=i,n.length>2||n[0]!==""||n[1]!==""?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=$}_$AI(e,t=this,n,r){const i=this.strings;let o=!1;if(i===void 0)e=Te(this,e,t,0),o=!qe(e)||e!==this._$AH&&e!==ue,o&&(this._$AH=e);else{const l=e;let c,h;for(e=i[0],c=0;c<i.length-1;c++)h=Te(this,l[n+c],t,c),h===ue&&(h=this._$AH[c]),o||(o=!qe(h)||h!==this._$AH[c]),h===$?e=$:e!==$&&(e+=(h??"")+i[c+1]),this._$AH[c]=h}o&&!r&&this.j(e)}j(e){e===$?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}},ar=class extends ot{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===$?void 0:e}},lr=class extends ot{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==$)}},cr=class extends ot{constructor(e,t,n,r,i){super(e,t,n,r,i),this.type=5}_$AI(e,t=this){if((e=Te(this,e,t,0)??$)===ue)return;const n=this._$AH,r=e===$&&n!==$||e.capture!==n.capture||e.once!==n.once||e.passive!==n.passive,i=e!==$&&(n===$||r);r&&this.element.removeEventListener(this.name,this,n),i&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t;typeof this._$AH=="function"?this._$AH.call(((t=this.options)==null?void 0:t.host)??this.element,e):this._$AH.handleEvent(e)}},hr=class{constructor(e,t,n){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(e){Te(this,e)}};const zt=He.litHtmlPolyfillSupport;zt==null||zt(Mt,Nt),(He.litHtmlVersions??(He.litHtmlVersions=[])).push("3.3.1");const pr=(s,e,t)=>{const n=(t==null?void 0:t.renderBefore)??e;let r=n._$litPart$;if(r===void 0){const i=(t==null?void 0:t.renderBefore)??null;n._$litPart$=r=new Nt(e.insertBefore(Be(),i),i,void 0,t??{})}return r._$AI(s),r};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const fe=globalThis;let q=class extends $e{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t;const e=super.createRenderRoot();return(t=this.renderOptions).renderBefore??(t.renderBefore=e.firstChild),e}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=pr(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),(e=this._$Do)==null||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),(e=this._$Do)==null||e.setConnected(!1)}render(){return ue}};q._$litElement$=!0,q.finalized=!0,(yn=fe.litElementHydrateSupport)==null||yn.call(fe,{LitElement:q});const Ut=fe.litElementPolyfillSupport;Ut==null||Ut({LitElement:q}),(fe.litElementVersions??(fe.litElementVersions=[])).push("4.2.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const X=s=>(e,t)=>{t!==void 0?t.addInitializer(()=>{customElements.define(s,e)}):customElements.define(s,e)};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const ur={attribute:!0,type:String,converter:rt,reflect:!1,hasChanged:Pt},dr=(s=ur,e,t)=>{const{kind:n,metadata:r}=t;let i=globalThis.litPropertyMetadata.get(r);if(i===void 0&&globalThis.litPropertyMetadata.set(r,i=new Map),n==="setter"&&((s=Object.create(s)).wrapped=!0),i.set(t.name,s),n==="accessor"){const{name:o}=t;return{set(l){const c=e.get.call(this);e.set.call(this,l),this.requestUpdate(o,c,s)},init(l){return l!==void 0&&this.C(o,void 0,s,l),l}}}if(n==="setter"){const{name:o}=t;return function(l){const c=this[o];e.call(this,l),this.requestUpdate(o,c,s)}}throw Error("Unsupported decorator location: "+n)};function T(s){return(e,t)=>typeof t=="object"?dr(s,e,t):((n,r,i)=>{const o=r.hasOwnProperty(i);return r.constructor.createProperty(i,n),o?Object.getOwnPropertyDescriptor(r,i):void 0})(s,e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function zs(s){return T({...s,state:!0,attribute:!1})}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const fr=(s,e,t)=>(t.configurable=!0,t.enumerable=!0,Reflect.decorate&&typeof e!="object"&&Object.defineProperty(s,e,t),t);/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function gr(s,e){return(t,n,r)=>{const i=o=>{var l;return((l=o.renderRoot)==null?void 0:l.querySelector(s))??null};return fr(t,n,{get(){return i(this)}})}}const mr=()=>{const s=document.querySelectorAll("script");return Array.from(s).find(e=>{var t;return((t=e.src)==null?void 0:t.includes("widget"))||e.dataset.site})};function br(s){const e=document.currentScript||mr();if(!e){console.warn("[ChatbotWidget] Không tìm thấy <script> để đọc config.");return}const n=new URL(e.src,location.href).searchParams,r=window.ChatboxWidgetConfig;r&&(r.position&&(s.position=r.position),r.themeColor&&(s.themeColor=r.themeColor),r.title&&(s.title=r.title));const i=n.get("id");i&&(s.siteId=i);const o=e.dataset.site;!i&&o&&(s.siteId=o);const l=e.dataset.token;l&&(s.siteToken=l),s.style.setProperty("--chatbot-primary-color",s.themeColor),s.style.setProperty("--chatbot-primary-light-color",s.themeColor+"B3"),s.style.setProperty("--chatbot-position",s.position)}function _r(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Ee=1e3,ve=Ee*60,Re=ve*60,ge=Re*24,yr=ge*7,xr=ge*365.25,kr=function(s,e){e=e||{};var t=typeof s;if(t==="string"&&s.length>0)return wr(s);if(t==="number"&&isFinite(s))return e.long?Sr(s):Ar(s);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(s))};function wr(s){if(s=String(s),!(s.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(s);if(e){var t=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return t*xr;case"weeks":case"week":case"w":return t*yr;case"days":case"day":case"d":return t*ge;case"hours":case"hour":case"hrs":case"hr":case"h":return t*Re;case"minutes":case"minute":case"mins":case"min":case"m":return t*ve;case"seconds":case"second":case"secs":case"sec":case"s":return t*Ee;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function Ar(s){var e=Math.abs(s);return e>=ge?Math.round(s/ge)+"d":e>=Re?Math.round(s/Re)+"h":e>=ve?Math.round(s/ve)+"m":e>=Ee?Math.round(s/Ee)+"s":s+"ms"}function Sr(s){var e=Math.abs(s);return e>=ge?at(s,e,ge,"day"):e>=Re?at(s,e,Re,"hour"):e>=ve?at(s,e,ve,"minute"):e>=Ee?at(s,e,Ee,"second"):s+" ms"}function at(s,e,t,n){var r=e>=t*1.5;return Math.round(s/t)+" "+n+(r?"s":"")}const $r=_r(kr);function Tr(s){return(typeof s=="string"?new Date(s):s).getTime()<Date.now()}const K={TOKEN:"chatbot-token",SESSION_ID:"chatbot-session-id",EXPIRES_AT:"chatbot-expires-at"};function Er(){const s=localStorage.getItem(K.TOKEN),e=localStorage.getItem(K.EXPIRES_AT),t=localStorage.getItem(K.SESSION_ID);return!s||!e||!t?null:Tr(e)?(console.log("[SessionService] Stored session expired. Clearing..."),vr(),null):{token:s,sessionId:t,expiresAt:e}}function vr(){localStorage.removeItem(K.TOKEN),localStorage.removeItem(K.SESSION_ID),localStorage.removeItem(K.EXPIRES_AT)}async function Rr(s){console.log("[SessionService] Requesting new session...");try{const e=await fetch("http://localhost:3000/session/initiate",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":s},body:JSON.stringify({origin:window.location.origin})});if(!e.ok){const l=await e.json();throw new Error(l.error||"Failed to initiate session")}const{token:t,sessionId:n,expiresIn:r}=await e.json(),i=new Date(Date.now()+$r(r)).toISOString();localStorage.setItem(K.TOKEN,t),localStorage.setItem(K.SESSION_ID,n),localStorage.setItem(K.EXPIRES_AT,i);const o={token:t,sessionId:n,expiresAt:i};return console.log("[SessionService] New session initiated and stored:",o),o}catch(e){throw console.error("[SessionService] Error requesting new session:",e),e}}function Cr(s,e){console.log("[SessionService] Using session:",s),e(s.token,s.sessionId)}var ce=(s=>(s.User="user",s.Assistant="assistant",s))(ce||{});const Ir=Object.values(ce);function Or(s){return typeof s=="string"&&Ir.includes(s)}function Pr(s){return Or(s)?s:ce.User}async function Lr(s,e,t,n){console.log("[MessageService] Sending message...");try{const r={"Content-Type":"application/json",Authorization:`Bearer ${t}`,"x-session-id":n,"x-api-key":s},i=e.map(c=>({role:Pr(c.role),content:c.content})),o=await fetch("http://localhost:3000/chat/generate",{method:"POST",headers:r,body:JSON.stringify({messages:i,sessionId:n})});if(!o.ok){const c=await o.json();throw new Error(c.error||"Failed to get AI response")}const l=await o.json();return console.log("[MessageService] Received AI response:",l),l.response}catch(r){throw console.error("[MessageService] Error sending message:",r),r}}function Ht(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var me=Ht();function Us(s){me=s}var je={exec:()=>null};function x(s,e=""){let t=typeof s=="string"?s:s.source,n={replace:(r,i)=>{let o=typeof i=="string"?i:i.source;return o=o.replace(M.caret,"$1"),t=t.replace(r,o),n},getRegex:()=>new RegExp(t,e)};return n}var M={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:s=>new RegExp(`^( {0,3}${s})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:s=>new RegExp(`^ {0,${Math.min(3,s-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:s=>new RegExp(`^ {0,${Math.min(3,s-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:s=>new RegExp(`^ {0,${Math.min(3,s-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:s=>new RegExp(`^ {0,${Math.min(3,s-1)}}#`),htmlBeginRegex:s=>new RegExp(`^ {0,${Math.min(3,s-1)}}<(?:[a-z].*>|!--)`,"i")},Dr=/^(?:[ \t]*(?:\n|$))+/,Mr=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Nr=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,We=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,zr=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Bt=/(?:[*+-]|\d{1,9}[.)])/,Hs=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Bs=x(Hs).replace(/bull/g,Bt).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Ur=x(Hs).replace(/bull/g,Bt).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),qt=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Hr=/^[^\n]+/,Ft=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Br=x(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Ft).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),qr=x(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Bt).getRegex(),lt="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",jt=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Fr=x("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",jt).replace("tag",lt).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),qs=x(qt).replace("hr",We).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",lt).getRegex(),jr=x(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",qs).getRegex(),Wt={blockquote:jr,code:Mr,def:Br,fences:Nr,heading:zr,hr:We,html:Fr,lheading:Bs,list:qr,newline:Dr,paragraph:qs,table:je,text:Hr},Fs=x("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",We).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",lt).getRegex(),Wr={...Wt,lheading:Ur,table:Fs,paragraph:x(qt).replace("hr",We).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Fs).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",lt).getRegex()},Gr={...Wt,html:x(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",jt).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:je,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:x(qt).replace("hr",We).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Bs).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Vr=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Zr=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,js=/^( {2,}|\\)\n(?!\s*$)/,Yr=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,ct=/[\p{P}\p{S}]/u,Gt=/[\s\p{P}\p{S}]/u,Ws=/[^\s\p{P}\p{S}]/u,Xr=x(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Gt).getRegex(),Gs=/(?!~)[\p{P}\p{S}]/u,Kr=/(?!~)[\s\p{P}\p{S}]/u,Qr=/(?:[^\s\p{P}\p{S}]|~)/u,Jr=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,Vs=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,ei=x(Vs,"u").replace(/punct/g,ct).getRegex(),ti=x(Vs,"u").replace(/punct/g,Gs).getRegex(),Zs="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",si=x(Zs,"gu").replace(/notPunctSpace/g,Ws).replace(/punctSpace/g,Gt).replace(/punct/g,ct).getRegex(),ni=x(Zs,"gu").replace(/notPunctSpace/g,Qr).replace(/punctSpace/g,Kr).replace(/punct/g,Gs).getRegex(),ri=x("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Ws).replace(/punctSpace/g,Gt).replace(/punct/g,ct).getRegex(),ii=x(/\\(punct)/,"gu").replace(/punct/g,ct).getRegex(),oi=x(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),ai=x(jt).replace("(?:-->|$)","-->").getRegex(),li=x("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",ai).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),ht=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,ci=x(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",ht).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Ys=x(/^!?\[(label)\]\[(ref)\]/).replace("label",ht).replace("ref",Ft).getRegex(),Xs=x(/^!?\[(ref)\](?:\[\])?/).replace("ref",Ft).getRegex(),hi=x("reflink|nolink(?!\\()","g").replace("reflink",Ys).replace("nolink",Xs).getRegex(),Vt={_backpedal:je,anyPunctuation:ii,autolink:oi,blockSkip:Jr,br:js,code:Zr,del:je,emStrongLDelim:ei,emStrongRDelimAst:si,emStrongRDelimUnd:ri,escape:Vr,link:ci,nolink:Xs,punctuation:Xr,reflink:Ys,reflinkSearch:hi,tag:li,text:Yr,url:je},pi={...Vt,link:x(/^!?\[(label)\]\((.*?)\)/).replace("label",ht).getRegex(),reflink:x(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ht).getRegex()},Zt={...Vt,emStrongRDelimAst:ni,emStrongLDelim:ti,url:x(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},ui={...Zt,br:x(js).replace("{2,}","*").getRegex(),text:x(Zt.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},pt={normal:Wt,gfm:Wr,pedantic:Gr},Ge={normal:Vt,gfm:Zt,breaks:ui,pedantic:pi},di={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ks=s=>di[s];function V(s,e){if(e){if(M.escapeTest.test(s))return s.replace(M.escapeReplace,Ks)}else if(M.escapeTestNoEncode.test(s))return s.replace(M.escapeReplaceNoEncode,Ks);return s}function Qs(s){try{s=encodeURI(s).replace(M.percentDecode,"%")}catch{return null}return s}function Js(s,e){var i;let t=s.replace(M.findPipe,(o,l,c)=>{let h=!1,p=l;for(;--p>=0&&c[p]==="\\";)h=!h;return h?"|":" |"}),n=t.split(M.splitPipe),r=0;if(n[0].trim()||n.shift(),n.length>0&&!((i=n.at(-1))!=null&&i.trim())&&n.pop(),e)if(n.length>e)n.splice(e);else for(;n.length<e;)n.push("");for(;r<n.length;r++)n[r]=n[r].trim().replace(M.slashPipe,"|");return n}function Ve(s,e,t){let n=s.length;if(n===0)return"";let r=0;for(;r<n&&s.charAt(n-r-1)===e;)r++;return s.slice(0,n-r)}function fi(s,e){if(s.indexOf(e[1])===-1)return-1;let t=0;for(let n=0;n<s.length;n++)if(s[n]==="\\")n++;else if(s[n]===e[0])t++;else if(s[n]===e[1]&&(t--,t<0))return n;return t>0?-2:-1}function en(s,e,t,n,r){let i=e.href,o=e.title||null,l=s[1].replace(r.other.outputLinkReplace,"$1");n.state.inLink=!0;let c={type:s[0].charAt(0)==="!"?"image":"link",raw:t,href:i,title:o,text:l,tokens:n.inlineTokens(l)};return n.state.inLink=!1,c}function gi(s,e,t){let n=s.match(t.other.indentCodeCompensation);if(n===null)return e;let r=n[1];return e.split(`
`).map(i=>{let o=i.match(t.other.beginningSpace);if(o===null)return i;let[l]=o;return l.length>=r.length?i.slice(r.length):i}).join(`
`)}var ut=class{constructor(s){w(this,"options");w(this,"rules");w(this,"lexer");this.options=s||me}space(s){let e=this.rules.block.newline.exec(s);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(s){let e=this.rules.block.code.exec(s);if(e){let t=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?t:Ve(t,`
`)}}}fences(s){let e=this.rules.block.fences.exec(s);if(e){let t=e[0],n=gi(t,e[3]||"",this.rules);return{type:"code",raw:t,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:n}}}heading(s){let e=this.rules.block.heading.exec(s);if(e){let t=e[2].trim();if(this.rules.other.endingHash.test(t)){let n=Ve(t,"#");(this.options.pedantic||!n||this.rules.other.endingSpaceChar.test(n))&&(t=n.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(s){let e=this.rules.block.hr.exec(s);if(e)return{type:"hr",raw:Ve(e[0],`
`)}}blockquote(s){let e=this.rules.block.blockquote.exec(s);if(e){let t=Ve(e[0],`
`).split(`
`),n="",r="",i=[];for(;t.length>0;){let o=!1,l=[],c;for(c=0;c<t.length;c++)if(this.rules.other.blockquoteStart.test(t[c]))l.push(t[c]),o=!0;else if(!o)l.push(t[c]);else break;t=t.slice(c);let h=l.join(`
`),p=h.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");n=n?`${n}
${h}`:h,r=r?`${r}
${p}`:p;let g=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(p,i,!0),this.lexer.state.top=g,t.length===0)break;let d=i.at(-1);if((d==null?void 0:d.type)==="code")break;if((d==null?void 0:d.type)==="blockquote"){let y=d,_=y.raw+`
`+t.join(`
`),P=this.blockquote(_);i[i.length-1]=P,n=n.substring(0,n.length-y.raw.length)+P.raw,r=r.substring(0,r.length-y.text.length)+P.text;break}else if((d==null?void 0:d.type)==="list"){let y=d,_=y.raw+`
`+t.join(`
`),P=this.list(_);i[i.length-1]=P,n=n.substring(0,n.length-d.raw.length)+P.raw,r=r.substring(0,r.length-y.raw.length)+P.raw,t=_.substring(i.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:n,tokens:i,text:r}}}list(s){let e=this.rules.block.list.exec(s);if(e){let t=e[1].trim(),n=t.length>1,r={type:"list",raw:"",ordered:n,start:n?+t.slice(0,-1):"",loose:!1,items:[]};t=n?`\\d{1,9}\\${t.slice(-1)}`:`\\${t}`,this.options.pedantic&&(t=n?t:"[*+-]");let i=this.rules.other.listItemRegex(t),o=!1;for(;s;){let c=!1,h="",p="";if(!(e=i.exec(s))||this.rules.block.hr.test(s))break;h=e[0],s=s.substring(h.length);let g=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,Je=>" ".repeat(3*Je.length)),d=s.split(`
`,1)[0],y=!g.trim(),_=0;if(this.options.pedantic?(_=2,p=g.trimStart()):y?_=e[1].length+1:(_=e[2].search(this.rules.other.nonSpaceChar),_=_>4?1:_,p=g.slice(_),_+=e[1].length),y&&this.rules.other.blankLine.test(d)&&(h+=d+`
`,s=s.substring(d.length+1),c=!0),!c){let Je=this.rules.other.nextBulletRegex(_),St=this.rules.other.hrRegex(_),xe=this.rules.other.fencesBeginRegex(_),v=this.rules.other.headingBeginRegex(_),ke=this.rules.other.htmlBeginRegex(_);for(;s;){let we=s.split(`
`,1)[0],Ae;if(d=we,this.options.pedantic?(d=d.replace(this.rules.other.listReplaceNesting,"  "),Ae=d):Ae=d.replace(this.rules.other.tabCharGlobal,"    "),xe.test(d)||v.test(d)||ke.test(d)||Je.test(d)||St.test(d))break;if(Ae.search(this.rules.other.nonSpaceChar)>=_||!d.trim())p+=`
`+Ae.slice(_);else{if(y||g.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||xe.test(g)||v.test(g)||St.test(g))break;p+=`
`+d}!y&&!d.trim()&&(y=!0),h+=we+`
`,s=s.substring(we.length+1),g=Ae.slice(_)}}r.loose||(o?r.loose=!0:this.rules.other.doubleBlankLine.test(h)&&(o=!0));let P=null,At;this.options.gfm&&(P=this.rules.other.listIsTask.exec(p),P&&(At=P[0]!=="[ ] ",p=p.replace(this.rules.other.listReplaceTask,""))),r.items.push({type:"list_item",raw:h,task:!!P,checked:At,loose:!1,text:p,tokens:[]}),r.raw+=h}let l=r.items.at(-1);if(l)l.raw=l.raw.trimEnd(),l.text=l.text.trimEnd();else return;r.raw=r.raw.trimEnd();for(let c=0;c<r.items.length;c++)if(this.lexer.state.top=!1,r.items[c].tokens=this.lexer.blockTokens(r.items[c].text,[]),!r.loose){let h=r.items[c].tokens.filter(g=>g.type==="space"),p=h.length>0&&h.some(g=>this.rules.other.anyLine.test(g.raw));r.loose=p}if(r.loose)for(let c=0;c<r.items.length;c++)r.items[c].loose=!0;return r}}html(s){let e=this.rules.block.html.exec(s);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(s){let e=this.rules.block.def.exec(s);if(e){let t=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),n=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",r=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:t,raw:e[0],href:n,title:r}}}table(s){var o;let e=this.rules.block.table.exec(s);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let t=Js(e[1]),n=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),r=(o=e[3])!=null&&o.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],i={type:"table",raw:e[0],header:[],align:[],rows:[]};if(t.length===n.length){for(let l of n)this.rules.other.tableAlignRight.test(l)?i.align.push("right"):this.rules.other.tableAlignCenter.test(l)?i.align.push("center"):this.rules.other.tableAlignLeft.test(l)?i.align.push("left"):i.align.push(null);for(let l=0;l<t.length;l++)i.header.push({text:t[l],tokens:this.lexer.inline(t[l]),header:!0,align:i.align[l]});for(let l of r)i.rows.push(Js(l,i.header.length).map((c,h)=>({text:c,tokens:this.lexer.inline(c),header:!1,align:i.align[h]})));return i}}lheading(s){let e=this.rules.block.lheading.exec(s);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(s){let e=this.rules.block.paragraph.exec(s);if(e){let t=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:t,tokens:this.lexer.inline(t)}}}text(s){let e=this.rules.block.text.exec(s);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(s){let e=this.rules.inline.escape.exec(s);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(s){let e=this.rules.inline.tag.exec(s);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(s){let e=this.rules.inline.link.exec(s);if(e){let t=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(t)){if(!this.rules.other.endAngleBracket.test(t))return;let i=Ve(t.slice(0,-1),"\\");if((t.length-i.length)%2===0)return}else{let i=fi(e[2],"()");if(i===-2)return;if(i>-1){let o=(e[0].indexOf("!")===0?5:4)+e[1].length+i;e[2]=e[2].substring(0,i),e[0]=e[0].substring(0,o).trim(),e[3]=""}}let n=e[2],r="";if(this.options.pedantic){let i=this.rules.other.pedanticHrefTitle.exec(n);i&&(n=i[1],r=i[3])}else r=e[3]?e[3].slice(1,-1):"";return n=n.trim(),this.rules.other.startAngleBracket.test(n)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(t)?n=n.slice(1):n=n.slice(1,-1)),en(e,{href:n&&n.replace(this.rules.inline.anyPunctuation,"$1"),title:r&&r.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(s,e){let t;if((t=this.rules.inline.reflink.exec(s))||(t=this.rules.inline.nolink.exec(s))){let n=(t[2]||t[1]).replace(this.rules.other.multipleSpaceGlobal," "),r=e[n.toLowerCase()];if(!r){let i=t[0].charAt(0);return{type:"text",raw:i,text:i}}return en(t,r,t[0],this.lexer,this.rules)}}emStrong(s,e,t=""){let n=this.rules.inline.emStrongLDelim.exec(s);if(!(!n||n[3]&&t.match(this.rules.other.unicodeAlphaNumeric))&&(!(n[1]||n[2])||!t||this.rules.inline.punctuation.exec(t))){let r=[...n[0]].length-1,i,o,l=r,c=0,h=n[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(h.lastIndex=0,e=e.slice(-1*s.length+r);(n=h.exec(e))!=null;){if(i=n[1]||n[2]||n[3]||n[4]||n[5]||n[6],!i)continue;if(o=[...i].length,n[3]||n[4]){l+=o;continue}else if((n[5]||n[6])&&r%3&&!((r+o)%3)){c+=o;continue}if(l-=o,l>0)continue;o=Math.min(o,o+l+c);let p=[...n[0]][0].length,g=s.slice(0,r+n.index+p+o);if(Math.min(r,o)%2){let y=g.slice(1,-1);return{type:"em",raw:g,text:y,tokens:this.lexer.inlineTokens(y)}}let d=g.slice(2,-2);return{type:"strong",raw:g,text:d,tokens:this.lexer.inlineTokens(d)}}}}codespan(s){let e=this.rules.inline.code.exec(s);if(e){let t=e[2].replace(this.rules.other.newLineCharGlobal," "),n=this.rules.other.nonSpaceChar.test(t),r=this.rules.other.startingSpaceChar.test(t)&&this.rules.other.endingSpaceChar.test(t);return n&&r&&(t=t.substring(1,t.length-1)),{type:"codespan",raw:e[0],text:t}}}br(s){let e=this.rules.inline.br.exec(s);if(e)return{type:"br",raw:e[0]}}del(s){let e=this.rules.inline.del.exec(s);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(s){let e=this.rules.inline.autolink.exec(s);if(e){let t,n;return e[2]==="@"?(t=e[1],n="mailto:"+t):(t=e[1],n=t),{type:"link",raw:e[0],text:t,href:n,tokens:[{type:"text",raw:t,text:t}]}}}url(s){var t;let e;if(e=this.rules.inline.url.exec(s)){let n,r;if(e[2]==="@")n=e[0],r="mailto:"+n;else{let i;do i=e[0],e[0]=((t=this.rules.inline._backpedal.exec(e[0]))==null?void 0:t[0])??"";while(i!==e[0]);n=e[0],e[1]==="www."?r="http://"+e[0]:r=e[0]}return{type:"link",raw:e[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(s){let e=this.rules.inline.text.exec(s);if(e){let t=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:t}}}},Q=class ks{constructor(e){w(this,"tokens");w(this,"options");w(this,"state");w(this,"tokenizer");w(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||me,this.options.tokenizer=this.options.tokenizer||new ut,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let t={other:M,block:pt.normal,inline:Ge.normal};this.options.pedantic?(t.block=pt.pedantic,t.inline=Ge.pedantic):this.options.gfm&&(t.block=pt.gfm,this.options.breaks?t.inline=Ge.breaks:t.inline=Ge.gfm),this.tokenizer.rules=t}static get rules(){return{block:pt,inline:Ge}}static lex(e,t){return new ks(t).lex(e)}static lexInline(e,t){return new ks(t).inlineTokens(e)}lex(e){e=e.replace(M.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){let n=this.inlineQueue[t];this.inlineTokens(n.src,n.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],n=!1){var r,i,o;for(this.options.pedantic&&(e=e.replace(M.tabCharGlobal,"    ").replace(M.spaceLine,""));e;){let l;if((i=(r=this.options.extensions)==null?void 0:r.block)!=null&&i.some(h=>(l=h.call({lexer:this},e,t))?(e=e.substring(l.raw.length),t.push(l),!0):!1))continue;if(l=this.tokenizer.space(e)){e=e.substring(l.raw.length);let h=t.at(-1);l.raw.length===1&&h!==void 0?h.raw+=`
`:t.push(l);continue}if(l=this.tokenizer.code(e)){e=e.substring(l.raw.length);let h=t.at(-1);(h==null?void 0:h.type)==="paragraph"||(h==null?void 0:h.type)==="text"?(h.raw+=`
`+l.raw,h.text+=`
`+l.text,this.inlineQueue.at(-1).src=h.text):t.push(l);continue}if(l=this.tokenizer.fences(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.heading(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.hr(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.blockquote(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.list(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.html(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.def(e)){e=e.substring(l.raw.length);let h=t.at(-1);(h==null?void 0:h.type)==="paragraph"||(h==null?void 0:h.type)==="text"?(h.raw+=`
`+l.raw,h.text+=`
`+l.raw,this.inlineQueue.at(-1).src=h.text):this.tokens.links[l.tag]||(this.tokens.links[l.tag]={href:l.href,title:l.title});continue}if(l=this.tokenizer.table(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.lheading(e)){e=e.substring(l.raw.length),t.push(l);continue}let c=e;if((o=this.options.extensions)!=null&&o.startBlock){let h=1/0,p=e.slice(1),g;this.options.extensions.startBlock.forEach(d=>{g=d.call({lexer:this},p),typeof g=="number"&&g>=0&&(h=Math.min(h,g))}),h<1/0&&h>=0&&(c=e.substring(0,h+1))}if(this.state.top&&(l=this.tokenizer.paragraph(c))){let h=t.at(-1);n&&(h==null?void 0:h.type)==="paragraph"?(h.raw+=`
`+l.raw,h.text+=`
`+l.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=h.text):t.push(l),n=c.length!==e.length,e=e.substring(l.raw.length);continue}if(l=this.tokenizer.text(e)){e=e.substring(l.raw.length);let h=t.at(-1);(h==null?void 0:h.type)==="text"?(h.raw+=`
`+l.raw,h.text+=`
`+l.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=h.text):t.push(l);continue}if(e){let h="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){var l,c,h;let n=e,r=null;if(this.tokens.links){let p=Object.keys(this.tokens.links);if(p.length>0)for(;(r=this.tokenizer.rules.inline.reflinkSearch.exec(n))!=null;)p.includes(r[0].slice(r[0].lastIndexOf("[")+1,-1))&&(n=n.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(r=this.tokenizer.rules.inline.anyPunctuation.exec(n))!=null;)n=n.slice(0,r.index)+"++"+n.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(r=this.tokenizer.rules.inline.blockSkip.exec(n))!=null;)n=n.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let i=!1,o="";for(;e;){i||(o=""),i=!1;let p;if((c=(l=this.options.extensions)==null?void 0:l.inline)!=null&&c.some(d=>(p=d.call({lexer:this},e,t))?(e=e.substring(p.raw.length),t.push(p),!0):!1))continue;if(p=this.tokenizer.escape(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.tag(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.link(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(p.raw.length);let d=t.at(-1);p.type==="text"&&(d==null?void 0:d.type)==="text"?(d.raw+=p.raw,d.text+=p.text):t.push(p);continue}if(p=this.tokenizer.emStrong(e,n,o)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.codespan(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.br(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.del(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.autolink(e)){e=e.substring(p.raw.length),t.push(p);continue}if(!this.state.inLink&&(p=this.tokenizer.url(e))){e=e.substring(p.raw.length),t.push(p);continue}let g=e;if((h=this.options.extensions)!=null&&h.startInline){let d=1/0,y=e.slice(1),_;this.options.extensions.startInline.forEach(P=>{_=P.call({lexer:this},y),typeof _=="number"&&_>=0&&(d=Math.min(d,_))}),d<1/0&&d>=0&&(g=e.substring(0,d+1))}if(p=this.tokenizer.inlineText(g)){e=e.substring(p.raw.length),p.raw.slice(-1)!=="_"&&(o=p.raw.slice(-1)),i=!0;let d=t.at(-1);(d==null?void 0:d.type)==="text"?(d.raw+=p.raw,d.text+=p.text):t.push(p);continue}if(e){let d="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(d);break}else throw new Error(d)}}return t}},dt=class{constructor(s){w(this,"options");w(this,"parser");this.options=s||me}space(s){return""}code({text:s,lang:e,escaped:t}){var i;let n=(i=(e||"").match(M.notSpaceStart))==null?void 0:i[0],r=s.replace(M.endingNewline,"")+`
`;return n?'<pre><code class="language-'+V(n)+'">'+(t?r:V(r,!0))+`</code></pre>
`:"<pre><code>"+(t?r:V(r,!0))+`</code></pre>
`}blockquote({tokens:s}){return`<blockquote>
${this.parser.parse(s)}</blockquote>
`}html({text:s}){return s}heading({tokens:s,depth:e}){return`<h${e}>${this.parser.parseInline(s)}</h${e}>
`}hr(s){return`<hr>
`}list(s){let e=s.ordered,t=s.start,n="";for(let o=0;o<s.items.length;o++){let l=s.items[o];n+=this.listitem(l)}let r=e?"ol":"ul",i=e&&t!==1?' start="'+t+'"':"";return"<"+r+i+`>
`+n+"</"+r+`>
`}listitem(s){var t;let e="";if(s.task){let n=this.checkbox({checked:!!s.checked});s.loose?((t=s.tokens[0])==null?void 0:t.type)==="paragraph"?(s.tokens[0].text=n+" "+s.tokens[0].text,s.tokens[0].tokens&&s.tokens[0].tokens.length>0&&s.tokens[0].tokens[0].type==="text"&&(s.tokens[0].tokens[0].text=n+" "+V(s.tokens[0].tokens[0].text),s.tokens[0].tokens[0].escaped=!0)):s.tokens.unshift({type:"text",raw:n+" ",text:n+" ",escaped:!0}):e+=n+" "}return e+=this.parser.parse(s.tokens,!!s.loose),`<li>${e}</li>
`}checkbox({checked:s}){return"<input "+(s?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:s}){return`<p>${this.parser.parseInline(s)}</p>
`}table(s){let e="",t="";for(let r=0;r<s.header.length;r++)t+=this.tablecell(s.header[r]);e+=this.tablerow({text:t});let n="";for(let r=0;r<s.rows.length;r++){let i=s.rows[r];t="";for(let o=0;o<i.length;o++)t+=this.tablecell(i[o]);n+=this.tablerow({text:t})}return n&&(n=`<tbody>${n}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+n+`</table>
`}tablerow({text:s}){return`<tr>
${s}</tr>
`}tablecell(s){let e=this.parser.parseInline(s.tokens),t=s.header?"th":"td";return(s.align?`<${t} align="${s.align}">`:`<${t}>`)+e+`</${t}>
`}strong({tokens:s}){return`<strong>${this.parser.parseInline(s)}</strong>`}em({tokens:s}){return`<em>${this.parser.parseInline(s)}</em>`}codespan({text:s}){return`<code>${V(s,!0)}</code>`}br(s){return"<br>"}del({tokens:s}){return`<del>${this.parser.parseInline(s)}</del>`}link({href:s,title:e,tokens:t}){let n=this.parser.parseInline(t),r=Qs(s);if(r===null)return n;s=r;let i='<a href="'+s+'"';return e&&(i+=' title="'+V(e)+'"'),i+=">"+n+"</a>",i}image({href:s,title:e,text:t,tokens:n}){n&&(t=this.parser.parseInline(n,this.parser.textRenderer));let r=Qs(s);if(r===null)return V(t);s=r;let i=`<img src="${s}" alt="${t}"`;return e&&(i+=` title="${V(e)}"`),i+=">",i}text(s){return"tokens"in s&&s.tokens?this.parser.parseInline(s.tokens):"escaped"in s&&s.escaped?s.text:V(s.text)}},Yt=class{strong({text:s}){return s}em({text:s}){return s}codespan({text:s}){return s}del({text:s}){return s}html({text:s}){return s}text({text:s}){return s}link({text:s}){return""+s}image({text:s}){return""+s}br(){return""}},J=class ws{constructor(e){w(this,"options");w(this,"renderer");w(this,"textRenderer");this.options=e||me,this.options.renderer=this.options.renderer||new dt,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Yt}static parse(e,t){return new ws(t).parse(e)}static parseInline(e,t){return new ws(t).parseInline(e)}parse(e,t=!0){var r,i;let n="";for(let o=0;o<e.length;o++){let l=e[o];if((i=(r=this.options.extensions)==null?void 0:r.renderers)!=null&&i[l.type]){let h=l,p=this.options.extensions.renderers[h.type].call({parser:this},h);if(p!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(h.type)){n+=p||"";continue}}let c=l;switch(c.type){case"space":{n+=this.renderer.space(c);continue}case"hr":{n+=this.renderer.hr(c);continue}case"heading":{n+=this.renderer.heading(c);continue}case"code":{n+=this.renderer.code(c);continue}case"table":{n+=this.renderer.table(c);continue}case"blockquote":{n+=this.renderer.blockquote(c);continue}case"list":{n+=this.renderer.list(c);continue}case"html":{n+=this.renderer.html(c);continue}case"paragraph":{n+=this.renderer.paragraph(c);continue}case"text":{let h=c,p=this.renderer.text(h);for(;o+1<e.length&&e[o+1].type==="text";)h=e[++o],p+=`
`+this.renderer.text(h);t?n+=this.renderer.paragraph({type:"paragraph",raw:p,text:p,tokens:[{type:"text",raw:p,text:p,escaped:!0}]}):n+=p;continue}default:{let h='Token with "'+c.type+'" type was not found.';if(this.options.silent)return console.error(h),"";throw new Error(h)}}}return n}parseInline(e,t=this.renderer){var r,i;let n="";for(let o=0;o<e.length;o++){let l=e[o];if((i=(r=this.options.extensions)==null?void 0:r.renderers)!=null&&i[l.type]){let h=this.options.extensions.renderers[l.type].call({parser:this},l);if(h!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(l.type)){n+=h||"";continue}}let c=l;switch(c.type){case"escape":{n+=t.text(c);break}case"html":{n+=t.html(c);break}case"link":{n+=t.link(c);break}case"image":{n+=t.image(c);break}case"strong":{n+=t.strong(c);break}case"em":{n+=t.em(c);break}case"codespan":{n+=t.codespan(c);break}case"br":{n+=t.br(c);break}case"del":{n+=t.del(c);break}case"text":{n+=t.text(c);break}default:{let h='Token with "'+c.type+'" type was not found.';if(this.options.silent)return console.error(h),"";throw new Error(h)}}}return n}},ft=(os=class{constructor(s){w(this,"options");w(this,"block");this.options=s||me}preprocess(s){return s}postprocess(s){return s}processAllTokens(s){return s}provideLexer(){return this.block?Q.lex:Q.lexInline}provideParser(){return this.block?J.parse:J.parseInline}},w(os,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"])),os),mi=class{constructor(...s){w(this,"defaults",Ht());w(this,"options",this.setOptions);w(this,"parse",this.parseMarkdown(!0));w(this,"parseInline",this.parseMarkdown(!1));w(this,"Parser",J);w(this,"Renderer",dt);w(this,"TextRenderer",Yt);w(this,"Lexer",Q);w(this,"Tokenizer",ut);w(this,"Hooks",ft);this.use(...s)}walkTokens(s,e){var n,r;let t=[];for(let i of s)switch(t=t.concat(e.call(this,i)),i.type){case"table":{let o=i;for(let l of o.header)t=t.concat(this.walkTokens(l.tokens,e));for(let l of o.rows)for(let c of l)t=t.concat(this.walkTokens(c.tokens,e));break}case"list":{let o=i;t=t.concat(this.walkTokens(o.items,e));break}default:{let o=i;(r=(n=this.defaults.extensions)==null?void 0:n.childTokens)!=null&&r[o.type]?this.defaults.extensions.childTokens[o.type].forEach(l=>{let c=o[l].flat(1/0);t=t.concat(this.walkTokens(c,e))}):o.tokens&&(t=t.concat(this.walkTokens(o.tokens,e)))}}return t}use(...s){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return s.forEach(t=>{let n={...t};if(n.async=this.defaults.async||n.async||!1,t.extensions&&(t.extensions.forEach(r=>{if(!r.name)throw new Error("extension name required");if("renderer"in r){let i=e.renderers[r.name];i?e.renderers[r.name]=function(...o){let l=r.renderer.apply(this,o);return l===!1&&(l=i.apply(this,o)),l}:e.renderers[r.name]=r.renderer}if("tokenizer"in r){if(!r.level||r.level!=="block"&&r.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let i=e[r.level];i?i.unshift(r.tokenizer):e[r.level]=[r.tokenizer],r.start&&(r.level==="block"?e.startBlock?e.startBlock.push(r.start):e.startBlock=[r.start]:r.level==="inline"&&(e.startInline?e.startInline.push(r.start):e.startInline=[r.start]))}"childTokens"in r&&r.childTokens&&(e.childTokens[r.name]=r.childTokens)}),n.extensions=e),t.renderer){let r=this.defaults.renderer||new dt(this.defaults);for(let i in t.renderer){if(!(i in r))throw new Error(`renderer '${i}' does not exist`);if(["options","parser"].includes(i))continue;let o=i,l=t.renderer[o],c=r[o];r[o]=(...h)=>{let p=l.apply(r,h);return p===!1&&(p=c.apply(r,h)),p||""}}n.renderer=r}if(t.tokenizer){let r=this.defaults.tokenizer||new ut(this.defaults);for(let i in t.tokenizer){if(!(i in r))throw new Error(`tokenizer '${i}' does not exist`);if(["options","rules","lexer"].includes(i))continue;let o=i,l=t.tokenizer[o],c=r[o];r[o]=(...h)=>{let p=l.apply(r,h);return p===!1&&(p=c.apply(r,h)),p}}n.tokenizer=r}if(t.hooks){let r=this.defaults.hooks||new ft;for(let i in t.hooks){if(!(i in r))throw new Error(`hook '${i}' does not exist`);if(["options","block"].includes(i))continue;let o=i,l=t.hooks[o],c=r[o];ft.passThroughHooks.has(i)?r[o]=h=>{if(this.defaults.async)return Promise.resolve(l.call(r,h)).then(g=>c.call(r,g));let p=l.call(r,h);return c.call(r,p)}:r[o]=(...h)=>{let p=l.apply(r,h);return p===!1&&(p=c.apply(r,h)),p}}n.hooks=r}if(t.walkTokens){let r=this.defaults.walkTokens,i=t.walkTokens;n.walkTokens=function(o){let l=[];return l.push(i.call(this,o)),r&&(l=l.concat(r.call(this,o))),l}}this.defaults={...this.defaults,...n}}),this}setOptions(s){return this.defaults={...this.defaults,...s},this}lexer(s,e){return Q.lex(s,e??this.defaults)}parser(s,e){return J.parse(s,e??this.defaults)}parseMarkdown(s){return(e,t)=>{let n={...t},r={...this.defaults,...n},i=this.onError(!!r.silent,!!r.async);if(this.defaults.async===!0&&n.async===!1)return i(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return i(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return i(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));r.hooks&&(r.hooks.options=r,r.hooks.block=s);let o=r.hooks?r.hooks.provideLexer():s?Q.lex:Q.lexInline,l=r.hooks?r.hooks.provideParser():s?J.parse:J.parseInline;if(r.async)return Promise.resolve(r.hooks?r.hooks.preprocess(e):e).then(c=>o(c,r)).then(c=>r.hooks?r.hooks.processAllTokens(c):c).then(c=>r.walkTokens?Promise.all(this.walkTokens(c,r.walkTokens)).then(()=>c):c).then(c=>l(c,r)).then(c=>r.hooks?r.hooks.postprocess(c):c).catch(i);try{r.hooks&&(e=r.hooks.preprocess(e));let c=o(e,r);r.hooks&&(c=r.hooks.processAllTokens(c)),r.walkTokens&&this.walkTokens(c,r.walkTokens);let h=l(c,r);return r.hooks&&(h=r.hooks.postprocess(h)),h}catch(c){return i(c)}}}onError(s,e){return t=>{if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,s){let n="<p>An error occurred:</p><pre>"+V(t.message+"",!0)+"</pre>";return e?Promise.resolve(n):n}if(e)return Promise.reject(t);throw t}}},be=new mi;function k(s,e){return be.parse(s,e)}k.options=k.setOptions=function(s){return be.setOptions(s),k.defaults=be.defaults,Us(k.defaults),k},k.getDefaults=Ht,k.defaults=me,k.use=function(...s){return be.use(...s),k.defaults=be.defaults,Us(k.defaults),k},k.walkTokens=function(s,e){return be.walkTokens(s,e)},k.parseInline=be.parseInline,k.Parser=J,k.parser=J.parse,k.Renderer=dt,k.TextRenderer=Yt,k.Lexer=Q,k.lexer=Q.lex,k.Tokenizer=ut,k.Hooks=ft,k.parse=k,k.options,k.setOptions,k.use,k.walkTokens,k.parseInline,J.parse,Q.lex;/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:tn,setPrototypeOf:sn,isFrozen:bi,getPrototypeOf:_i,getOwnPropertyDescriptor:yi}=Object;let{freeze:N,seal:F,create:nn}=Object,{apply:Xt,construct:Kt}=typeof Reflect<"u"&&Reflect;N||(N=function(e){return e}),F||(F=function(e){return e}),Xt||(Xt=function(e,t,n){return e.apply(t,n)}),Kt||(Kt=function(e,t){return new e(...t)});const gt=U(Array.prototype.forEach),xi=U(Array.prototype.lastIndexOf),rn=U(Array.prototype.pop),Ze=U(Array.prototype.push),ki=U(Array.prototype.splice),mt=U(String.prototype.toLowerCase),Qt=U(String.prototype.toString),on=U(String.prototype.match),Ye=U(String.prototype.replace),wi=U(String.prototype.indexOf),Ai=U(String.prototype.trim),W=U(Object.prototype.hasOwnProperty),z=U(RegExp.prototype.test),Xe=Si(TypeError);function U(s){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Xt(s,e,n)}}function Si(s){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Kt(s,t)}}function b(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:mt;sn&&sn(s,null);let n=e.length;for(;n--;){let r=e[n];if(typeof r=="string"){const i=t(r);i!==r&&(bi(e)||(e[n]=i),r=i)}s[r]=!0}return s}function $i(s){for(let e=0;e<s.length;e++)W(s,e)||(s[e]=null);return s}function ee(s){const e=nn(null);for(const[t,n]of tn(s))W(s,t)&&(Array.isArray(n)?e[t]=$i(n):n&&typeof n=="object"&&n.constructor===Object?e[t]=ee(n):e[t]=n);return e}function Ke(s,e){for(;s!==null;){const n=yi(s,e);if(n){if(n.get)return U(n.get);if(typeof n.value=="function")return U(n.value)}s=_i(s)}function t(){return null}return t}const an=N(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Jt=N(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),es=N(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Ti=N(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ts=N(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Ei=N(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),ln=N(["#text"]),cn=N(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),ss=N(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),hn=N(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),bt=N(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),vi=F(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Ri=F(/<%[\w\W]*|[\w\W]*%>/gm),Ci=F(/\$\{[\w\W]*/gm),Ii=F(/^data-[\-\w.\u00B7-\uFFFF]+$/),Oi=F(/^aria-[\-\w]+$/),pn=F(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Pi=F(/^(?:\w+script|data):/i),Li=F(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),un=F(/^html$/i),Di=F(/^[a-z][.\w]*(-[.\w]+)+$/i);var dn=Object.freeze({__proto__:null,ARIA_ATTR:Oi,ATTR_WHITESPACE:Li,CUSTOM_ELEMENT:Di,DATA_ATTR:Ii,DOCTYPE_NAME:un,ERB_EXPR:Ri,IS_ALLOWED_URI:pn,IS_SCRIPT_OR_DATA:Pi,MUSTACHE_EXPR:vi,TMPLIT_EXPR:Ci});const Qe={element:1,text:3,progressingInstruction:7,comment:8,document:9},Mi=function(){return typeof window>"u"?null:window},Ni=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const r="data-tt-policy-suffix";t&&t.hasAttribute(r)&&(n=t.getAttribute(r));const i="dompurify"+(n?"#"+n:"");try{return e.createPolicy(i,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},fn=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function gn(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Mi();const e=m=>gn(m);if(e.version="3.2.6",e.removed=[],!s||!s.document||s.document.nodeType!==Qe.document||!s.Element)return e.isSupported=!1,e;let{document:t}=s;const n=t,r=n.currentScript,{DocumentFragment:i,HTMLTemplateElement:o,Node:l,Element:c,NodeFilter:h,NamedNodeMap:p=s.NamedNodeMap||s.MozNamedAttrMap,HTMLFormElement:g,DOMParser:d,trustedTypes:y}=s,_=c.prototype,P=Ke(_,"cloneNode"),At=Ke(_,"remove"),Je=Ke(_,"nextSibling"),St=Ke(_,"childNodes"),xe=Ke(_,"parentNode");if(typeof o=="function"){const m=t.createElement("template");m.content&&m.content.ownerDocument&&(t=m.content.ownerDocument)}let v,ke="";const{implementation:we,createNodeIterator:Ae,createDocumentFragment:go,getElementsByTagName:mo}=t,{importNode:bo}=n;let H=fn();e.isSupported=typeof tn=="function"&&typeof xe=="function"&&we&&we.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:as,ERB_EXPR:ls,TMPLIT_EXPR:cs,DATA_ATTR:_o,ARIA_ATTR:yo,IS_SCRIPT_OR_DATA:xo,ATTR_WHITESPACE:xn,CUSTOM_ELEMENT:ko}=dn;let{IS_ALLOWED_URI:kn}=dn,R=null;const wn=b({},[...an,...Jt,...es,...ts,...ln]);let I=null;const An=b({},[...cn,...ss,...hn,...bt]);let S=Object.seal(nn(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),et=null,hs=null,Sn=!0,ps=!0,$n=!1,Tn=!0,Oe=!1,$t=!0,Se=!1,us=!1,ds=!1,Pe=!1,Tt=!1,Et=!1,En=!0,vn=!1;const wo="user-content-";let fs=!0,tt=!1,Le={},De=null;const Rn=b({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Cn=null;const In=b({},["audio","video","img","source","image","track"]);let gs=null;const On=b({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),vt="http://www.w3.org/1998/Math/MathML",Rt="http://www.w3.org/2000/svg",ne="http://www.w3.org/1999/xhtml";let Me=ne,ms=!1,bs=null;const Ao=b({},[vt,Rt,ne],Qt);let Ct=b({},["mi","mo","mn","ms","mtext"]),It=b({},["annotation-xml"]);const So=b({},["title","style","font","a","script"]);let st=null;const $o=["application/xhtml+xml","text/html"],To="text/html";let C=null,Ne=null;const Eo=t.createElement("form"),Pn=function(a){return a instanceof RegExp||a instanceof Function},_s=function(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Ne&&Ne===a)){if((!a||typeof a!="object")&&(a={}),a=ee(a),st=$o.indexOf(a.PARSER_MEDIA_TYPE)===-1?To:a.PARSER_MEDIA_TYPE,C=st==="application/xhtml+xml"?Qt:mt,R=W(a,"ALLOWED_TAGS")?b({},a.ALLOWED_TAGS,C):wn,I=W(a,"ALLOWED_ATTR")?b({},a.ALLOWED_ATTR,C):An,bs=W(a,"ALLOWED_NAMESPACES")?b({},a.ALLOWED_NAMESPACES,Qt):Ao,gs=W(a,"ADD_URI_SAFE_ATTR")?b(ee(On),a.ADD_URI_SAFE_ATTR,C):On,Cn=W(a,"ADD_DATA_URI_TAGS")?b(ee(In),a.ADD_DATA_URI_TAGS,C):In,De=W(a,"FORBID_CONTENTS")?b({},a.FORBID_CONTENTS,C):Rn,et=W(a,"FORBID_TAGS")?b({},a.FORBID_TAGS,C):ee({}),hs=W(a,"FORBID_ATTR")?b({},a.FORBID_ATTR,C):ee({}),Le=W(a,"USE_PROFILES")?a.USE_PROFILES:!1,Sn=a.ALLOW_ARIA_ATTR!==!1,ps=a.ALLOW_DATA_ATTR!==!1,$n=a.ALLOW_UNKNOWN_PROTOCOLS||!1,Tn=a.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Oe=a.SAFE_FOR_TEMPLATES||!1,$t=a.SAFE_FOR_XML!==!1,Se=a.WHOLE_DOCUMENT||!1,Pe=a.RETURN_DOM||!1,Tt=a.RETURN_DOM_FRAGMENT||!1,Et=a.RETURN_TRUSTED_TYPE||!1,ds=a.FORCE_BODY||!1,En=a.SANITIZE_DOM!==!1,vn=a.SANITIZE_NAMED_PROPS||!1,fs=a.KEEP_CONTENT!==!1,tt=a.IN_PLACE||!1,kn=a.ALLOWED_URI_REGEXP||pn,Me=a.NAMESPACE||ne,Ct=a.MATHML_TEXT_INTEGRATION_POINTS||Ct,It=a.HTML_INTEGRATION_POINTS||It,S=a.CUSTOM_ELEMENT_HANDLING||{},a.CUSTOM_ELEMENT_HANDLING&&Pn(a.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(S.tagNameCheck=a.CUSTOM_ELEMENT_HANDLING.tagNameCheck),a.CUSTOM_ELEMENT_HANDLING&&Pn(a.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(S.attributeNameCheck=a.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),a.CUSTOM_ELEMENT_HANDLING&&typeof a.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(S.allowCustomizedBuiltInElements=a.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Oe&&(ps=!1),Tt&&(Pe=!0),Le&&(R=b({},ln),I=[],Le.html===!0&&(b(R,an),b(I,cn)),Le.svg===!0&&(b(R,Jt),b(I,ss),b(I,bt)),Le.svgFilters===!0&&(b(R,es),b(I,ss),b(I,bt)),Le.mathMl===!0&&(b(R,ts),b(I,hn),b(I,bt))),a.ADD_TAGS&&(R===wn&&(R=ee(R)),b(R,a.ADD_TAGS,C)),a.ADD_ATTR&&(I===An&&(I=ee(I)),b(I,a.ADD_ATTR,C)),a.ADD_URI_SAFE_ATTR&&b(gs,a.ADD_URI_SAFE_ATTR,C),a.FORBID_CONTENTS&&(De===Rn&&(De=ee(De)),b(De,a.FORBID_CONTENTS,C)),fs&&(R["#text"]=!0),Se&&b(R,["html","head","body"]),R.table&&(b(R,["tbody"]),delete et.tbody),a.TRUSTED_TYPES_POLICY){if(typeof a.TRUSTED_TYPES_POLICY.createHTML!="function")throw Xe('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof a.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Xe('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');v=a.TRUSTED_TYPES_POLICY,ke=v.createHTML("")}else v===void 0&&(v=Ni(y,r)),v!==null&&typeof ke=="string"&&(ke=v.createHTML(""));N&&N(a),Ne=a}},Ln=b({},[...Jt,...es,...Ti]),Dn=b({},[...ts,...Ei]),vo=function(a){let u=xe(a);(!u||!u.tagName)&&(u={namespaceURI:Me,tagName:"template"});const f=mt(a.tagName),A=mt(u.tagName);return bs[a.namespaceURI]?a.namespaceURI===Rt?u.namespaceURI===ne?f==="svg":u.namespaceURI===vt?f==="svg"&&(A==="annotation-xml"||Ct[A]):!!Ln[f]:a.namespaceURI===vt?u.namespaceURI===ne?f==="math":u.namespaceURI===Rt?f==="math"&&It[A]:!!Dn[f]:a.namespaceURI===ne?u.namespaceURI===Rt&&!It[A]||u.namespaceURI===vt&&!Ct[A]?!1:!Dn[f]&&(So[f]||!Ln[f]):!!(st==="application/xhtml+xml"&&bs[a.namespaceURI]):!1},Z=function(a){Ze(e.removed,{element:a});try{xe(a).removeChild(a)}catch{At(a)}},ze=function(a,u){try{Ze(e.removed,{attribute:u.getAttributeNode(a),from:u})}catch{Ze(e.removed,{attribute:null,from:u})}if(u.removeAttribute(a),a==="is")if(Pe||Tt)try{Z(u)}catch{}else try{u.setAttribute(a,"")}catch{}},Mn=function(a){let u=null,f=null;if(ds)a="<remove></remove>"+a;else{const E=on(a,/^[\r\n\t ]+/);f=E&&E[0]}st==="application/xhtml+xml"&&Me===ne&&(a='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+a+"</body></html>");const A=v?v.createHTML(a):a;if(Me===ne)try{u=new d().parseFromString(A,st)}catch{}if(!u||!u.documentElement){u=we.createDocument(Me,"template",null);try{u.documentElement.innerHTML=ms?ke:A}catch{}}const L=u.body||u.documentElement;return a&&f&&L.insertBefore(t.createTextNode(f),L.childNodes[0]||null),Me===ne?mo.call(u,Se?"html":"body")[0]:Se?u.documentElement:L},Nn=function(a){return Ae.call(a.ownerDocument||a,a,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT|h.SHOW_PROCESSING_INSTRUCTION|h.SHOW_CDATA_SECTION,null)},ys=function(a){return a instanceof g&&(typeof a.nodeName!="string"||typeof a.textContent!="string"||typeof a.removeChild!="function"||!(a.attributes instanceof p)||typeof a.removeAttribute!="function"||typeof a.setAttribute!="function"||typeof a.namespaceURI!="string"||typeof a.insertBefore!="function"||typeof a.hasChildNodes!="function")},zn=function(a){return typeof l=="function"&&a instanceof l};function re(m,a,u){gt(m,f=>{f.call(e,a,u,Ne)})}const Un=function(a){let u=null;if(re(H.beforeSanitizeElements,a,null),ys(a))return Z(a),!0;const f=C(a.nodeName);if(re(H.uponSanitizeElement,a,{tagName:f,allowedTags:R}),$t&&a.hasChildNodes()&&!zn(a.firstElementChild)&&z(/<[/\w!]/g,a.innerHTML)&&z(/<[/\w!]/g,a.textContent)||a.nodeType===Qe.progressingInstruction||$t&&a.nodeType===Qe.comment&&z(/<[/\w]/g,a.data))return Z(a),!0;if(!R[f]||et[f]){if(!et[f]&&Bn(f)&&(S.tagNameCheck instanceof RegExp&&z(S.tagNameCheck,f)||S.tagNameCheck instanceof Function&&S.tagNameCheck(f)))return!1;if(fs&&!De[f]){const A=xe(a)||a.parentNode,L=St(a)||a.childNodes;if(L&&A){const E=L.length;for(let B=E-1;B>=0;--B){const ie=P(L[B],!0);ie.__removalCount=(a.__removalCount||0)+1,A.insertBefore(ie,Je(a))}}}return Z(a),!0}return a instanceof c&&!vo(a)||(f==="noscript"||f==="noembed"||f==="noframes")&&z(/<\/no(script|embed|frames)/i,a.innerHTML)?(Z(a),!0):(Oe&&a.nodeType===Qe.text&&(u=a.textContent,gt([as,ls,cs],A=>{u=Ye(u,A," ")}),a.textContent!==u&&(Ze(e.removed,{element:a.cloneNode()}),a.textContent=u)),re(H.afterSanitizeElements,a,null),!1)},Hn=function(a,u,f){if(En&&(u==="id"||u==="name")&&(f in t||f in Eo))return!1;if(!(ps&&!hs[u]&&z(_o,u))){if(!(Sn&&z(yo,u))){if(!I[u]||hs[u]){if(!(Bn(a)&&(S.tagNameCheck instanceof RegExp&&z(S.tagNameCheck,a)||S.tagNameCheck instanceof Function&&S.tagNameCheck(a))&&(S.attributeNameCheck instanceof RegExp&&z(S.attributeNameCheck,u)||S.attributeNameCheck instanceof Function&&S.attributeNameCheck(u))||u==="is"&&S.allowCustomizedBuiltInElements&&(S.tagNameCheck instanceof RegExp&&z(S.tagNameCheck,f)||S.tagNameCheck instanceof Function&&S.tagNameCheck(f))))return!1}else if(!gs[u]){if(!z(kn,Ye(f,xn,""))){if(!((u==="src"||u==="xlink:href"||u==="href")&&a!=="script"&&wi(f,"data:")===0&&Cn[a])){if(!($n&&!z(xo,Ye(f,xn,"")))){if(f)return!1}}}}}}return!0},Bn=function(a){return a!=="annotation-xml"&&on(a,ko)},qn=function(a){re(H.beforeSanitizeAttributes,a,null);const{attributes:u}=a;if(!u||ys(a))return;const f={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:I,forceKeepAttr:void 0};let A=u.length;for(;A--;){const L=u[A],{name:E,namespaceURI:B,value:ie}=L,nt=C(E),xs=ie;let D=E==="value"?xs:Ai(xs);if(f.attrName=nt,f.attrValue=D,f.keepAttr=!0,f.forceKeepAttr=void 0,re(H.uponSanitizeAttribute,a,f),D=f.attrValue,vn&&(nt==="id"||nt==="name")&&(ze(E,a),D=wo+D),$t&&z(/((--!?|])>)|<\/(style|title)/i,D)){ze(E,a);continue}if(f.forceKeepAttr)continue;if(!f.keepAttr){ze(E,a);continue}if(!Tn&&z(/\/>/i,D)){ze(E,a);continue}Oe&&gt([as,ls,cs],jn=>{D=Ye(D,jn," ")});const Fn=C(a.nodeName);if(!Hn(Fn,nt,D)){ze(E,a);continue}if(v&&typeof y=="object"&&typeof y.getAttributeType=="function"&&!B)switch(y.getAttributeType(Fn,nt)){case"TrustedHTML":{D=v.createHTML(D);break}case"TrustedScriptURL":{D=v.createScriptURL(D);break}}if(D!==xs)try{B?a.setAttributeNS(B,E,D):a.setAttribute(E,D),ys(a)?Z(a):rn(e.removed)}catch{ze(E,a)}}re(H.afterSanitizeAttributes,a,null)},Ro=function m(a){let u=null;const f=Nn(a);for(re(H.beforeSanitizeShadowDOM,a,null);u=f.nextNode();)re(H.uponSanitizeShadowNode,u,null),Un(u),qn(u),u.content instanceof i&&m(u.content);re(H.afterSanitizeShadowDOM,a,null)};return e.sanitize=function(m){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u=null,f=null,A=null,L=null;if(ms=!m,ms&&(m="<!-->"),typeof m!="string"&&!zn(m))if(typeof m.toString=="function"){if(m=m.toString(),typeof m!="string")throw Xe("dirty is not a string, aborting")}else throw Xe("toString is not a function");if(!e.isSupported)return m;if(us||_s(a),e.removed=[],typeof m=="string"&&(tt=!1),tt){if(m.nodeName){const ie=C(m.nodeName);if(!R[ie]||et[ie])throw Xe("root node is forbidden and cannot be sanitized in-place")}}else if(m instanceof l)u=Mn("<!---->"),f=u.ownerDocument.importNode(m,!0),f.nodeType===Qe.element&&f.nodeName==="BODY"||f.nodeName==="HTML"?u=f:u.appendChild(f);else{if(!Pe&&!Oe&&!Se&&m.indexOf("<")===-1)return v&&Et?v.createHTML(m):m;if(u=Mn(m),!u)return Pe?null:Et?ke:""}u&&ds&&Z(u.firstChild);const E=Nn(tt?m:u);for(;A=E.nextNode();)Un(A),qn(A),A.content instanceof i&&Ro(A.content);if(tt)return m;if(Pe){if(Tt)for(L=go.call(u.ownerDocument);u.firstChild;)L.appendChild(u.firstChild);else L=u;return(I.shadowroot||I.shadowrootmode)&&(L=bo.call(n,L,!0)),L}let B=Se?u.outerHTML:u.innerHTML;return Se&&R["!doctype"]&&u.ownerDocument&&u.ownerDocument.doctype&&u.ownerDocument.doctype.name&&z(un,u.ownerDocument.doctype.name)&&(B="<!DOCTYPE "+u.ownerDocument.doctype.name+`>
`+B),Oe&&gt([as,ls,cs],ie=>{B=Ye(B,ie," ")}),v&&Et?v.createHTML(B):B},e.setConfig=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};_s(m),us=!0},e.clearConfig=function(){Ne=null,us=!1},e.isValidAttribute=function(m,a,u){Ne||_s({});const f=C(m),A=C(a);return Hn(f,A,u)},e.addHook=function(m,a){typeof a=="function"&&Ze(H[m],a)},e.removeHook=function(m,a){if(a!==void 0){const u=xi(H[m],a);return u===-1?void 0:ki(H[m],u,1)[0]}return rn(H[m])},e.removeHooks=function(m){H[m]=[]},e.removeAllHooks=function(){H=fn()},e}var zi=gn();function Ui(s){const e=k.parse(s);return zi.sanitize(e)}class Hi{constructor(e){this.messages=[],this.quickReplies=[],this.errorState=null,this.isLoading=!1,this.sessionId=null,this.siteId="",this.siteToken="",this.lastPrompt="",this.quickRepliesDefault="",this.isInitialized=!1,(this.host=e).addController(this)}hostConnected(){}initialize(e,t){this.isInitialized||(this.isInitialized=!0,this.siteId=e,this.quickRepliesDefault=t,this.initSession())}async initSession(){this.isLoading=!0,this.host.requestUpdate();const e="<p>Xin chào! Tôi có thể giúp gì cho bạn hôm nay?</p>",t="<p>Lỗi: Không thể khởi tạo phiên chat.</p>";try{const n=Er();let r;n?r=n:r=await Rr(this.siteId),Cr(r,(i,o)=>{this.siteToken=i,this.sessionId=o}),this.errorState=null,this.quickRepliesDefault?this.quickReplies=this.quickRepliesDefault.split("|").map(i=>i.trim()):this.quickReplies=["Dịch vụ","Cần hỗ trợ","Chính sách"],this.messages.length===0&&(this.messages=[{content:e,role:ce.Assistant}])}catch(n){this.errorState="init",this.quickReplies=[],this.messages.length===0&&(this.messages=[{content:t,role:ce.Assistant}]),console.error("[ChatState] Failed to initiate session:",n)}finally{this.isLoading=!1,this.host.requestUpdate()}}async handleSubmit(e){const t=e.trim();if(this.isLoading||!t||!this.sessionId)return;this.isLoading=!0,this.lastPrompt=t,this.messages=[...this.messages,{content:t,role:ce.User}],this.host.requestUpdate();const n="Lỗi: Không lấy được câu trả lời.";try{const r=await Lr(this.siteId,this.messages,this.siteToken,this.sessionId),i=Ui(r);this.errorState=null,this.addAssistantMessage(i)}catch(r){this.errorState="reply",console.error("Error sending message:",r),this.addAssistantMessage(n)}finally{this.isLoading=!1,this.host.requestUpdate()}}retry(){this.errorState==="init"?this.initSession():this.errorState==="reply"&&this.lastPrompt&&this.handleSubmit(this.lastPrompt)}addAssistantMessage(e){this.messages=[...this.messages,{content:e,role:ce.Assistant}]}}class Bi{constructor(e){this.teaserVisible=!1,this.teaserTimeout=null,(this.host=e).addController(this)}hostConnected(){this.teaserTimeout=window.setTimeout(()=>{this.teaserVisible=!0,this.host.requestUpdate()},3e3)}hostDisconnected(){this.teaserTimeout&&clearTimeout(this.teaserTimeout)}dismiss(){this.teaserTimeout&&(clearTimeout(this.teaserTimeout),this.teaserTimeout=null),this.teaserVisible&&(this.teaserVisible=!1,this.host.requestUpdate())}}class qi{constructor(e){this.typingIndicator=null,this.typingInterval=null,(this.host=e).addController(this)}hostDisconnected(){this.stop()}start(){if(this.typingInterval)return;const e=".";this.typingIndicator=`Đang gõ ${e.repeat(3)}`,this.host.requestUpdate();let t=0;this.typingInterval=window.setInterval(()=>{t=(t+1)%4,this.typingIndicator=`Đang gõ ${e.repeat(t)}`,this.host.requestUpdate()},500)}stop(){this.typingInterval&&(clearInterval(this.typingInterval),this.typingInterval=null),this.typingIndicator&&(this.typingIndicator=null,this.host.requestUpdate())}}const Fi=Y`
  :host {
    display: block;
    font-size: 13px;
    font-family: sans-serif;
  }
`;var ji=Object.getOwnPropertyDescriptor,Wi=(s,e,t,n)=>{for(var r=n>1?void 0:n?ji(e,t):e,i=s.length-1,o;i>=0;i--)(o=s[i])&&(r=o(r)||r);return r};let ns=class extends q{render(){return O` <button @click=${this._handleClick}>&#x1F4AC;</button> `}_handleClick(){this.dispatchEvent(new CustomEvent("open-chat",{bubbles:!0,composed:!0}))}};ns.styles=Y`
    :host {
      display: block;
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 1000;
    }

    button {
      background-color: var(--chatbot-primary-color, #4caf50);
      color: white;
      border: none;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      font-size: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      transition: transform 0.3s ease;
    }

    button:hover {
      transform: scale(1.05);
    }
  `,ns=Wi([X("chat-launcher")],ns);var Gi=Object.getOwnPropertyDescriptor,Vi=(s,e,t,n)=>{for(var r=n>1?void 0:n?Gi(e,t):e,i=s.length-1,o;i>=0;i--)(o=s[i])&&(r=o(r)||r);return r};let rs=class extends q{render(){return O`<div>Xin chào! Tôi có thể giúp gì cho bạn?</div>`}};rs.styles=Y`
    :host {
      position: fixed;
      bottom: 90px; /* Above the launcher */
      right: 20px;
      background-color: #fff;
      color: #333;
      padding: 12px 15px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.15);
      z-index: 999;
      font-size: 14px;
      max-width: 250px;
      animation: slide-in 0.5s forwards;
    }

    @keyframes slide-in {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  `,rs=Vi([X("teaser-message")],rs);const Zi=Y`
  :host {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 350px;
    height: 500px;
    max-height: 80vh;
    background-color: #fff;
    border-radius: 10px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    transition: all 0.3s ease;
    z-index: 1000;
  }
`;var Yi=Object.defineProperty,Xi=Object.getOwnPropertyDescriptor,mn=(s,e,t,n)=>{for(var r=n>1?void 0:n?Xi(e,t):e,i=s.length-1,o;i>=0;i--)(o=s[i])&&(r=(n?o(e,t,r):o(r))||r);return n&&r&&Yi(e,t,r),r};let _t=class extends q{constructor(){super(...arguments),this.title="Chatbot"}render(){return O`
      <div class="header">
        <span>${this.title}</span>
        <button class="minimize-btn" @click=${this._handleMinimizeClick}>&times;</button>
      </div>
    `}_handleMinimizeClick(){this.dispatchEvent(new CustomEvent("minimize",{bubbles:!0,composed:!0}))}};_t.styles=Y`
    .header {
      background-color: var(--chatbot-primary-color, #4caf50);
      color: white;
      padding: 15px;
      font-size: 18px;
      font-weight: bold;
      text-align: center;
      border-top-left-radius: 10px;
      border-top-right-radius: 10px;
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .minimize-btn {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: white;
      font-size: 24px;
      cursor: pointer;
    }
  `,mn([T({type:String})],_t.prototype,"title",2),_t=mn([X("chat-header")],_t);/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ki={CHILD:2},Qi=s=>(...e)=>({_$litDirective$:s,values:e});class Ji{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,t,n){this._$Ct=e,this._$AM=t,this._$Ci=n}_$AS(e,t){return this.update(e,t)}update(e,t){return this.render(...t)}}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class is extends Ji{constructor(e){if(super(e),this.it=$,e.type!==Ki.CHILD)throw Error(this.constructor.directiveName+"() can only be used in child bindings")}render(e){if(e===$||e==null)return this._t=void 0,this.it=e;if(e===ue)return e;if(typeof e!="string")throw Error(this.constructor.directiveName+"() called with a non-string value");if(e===this.it)return this._t;this.it=e;const t=[e];return t.raw=t,this._t={_$litType$:this.constructor.resultType,strings:t,values:[]}}}is.directiveName="unsafeHTML",is.resultType=1;const eo=Qi(is);var to=Object.defineProperty,so=Object.getOwnPropertyDescriptor,yt=(s,e,t,n)=>{for(var r=n>1?void 0:n?so(e,t):e,i=s.length-1,o;i>=0;i--)(o=s[i])&&(r=(n?o(e,t,r):o(r))||r);return n&&r&&to(e,t,r),r};let Ce=class extends q{constructor(){super(...arguments),this.messages=[],this.typingIndicator=null}updated(s){(s.has("messages")||s.has("typingIndicator"))&&this.performScrollToBottom()}render(){return O`
      <div class="messages">
        ${this.messages.map(s=>O`<div class="message ${s.role}">
            ${s.role===ce.Assistant?eo(s.content):s.content}
          </div>`)}
        ${this.typingIndicator?O`<div class="message assistant typing">${this.typingIndicator}</div>`:""}
      </div>
    `}performScrollToBottom(){Promise.resolve().then(()=>{this._messagesContainer&&(this._messagesContainer.scrollTop=this._messagesContainer.scrollHeight)})}};Ce.styles=Y`
    :host {
      display: flex;
      flex-direction: column;
      flex-grow: 1;
      overflow: hidden; /* To contain the scrolling messages div */
    }

    .messages {
      flex-grow: 1;
      padding: 15px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 10px;
      background-color: #f9f9f9;
    }

    .message {
      max-width: 80%;
      padding: 8px 12px;
      border-radius: 15px;
      word-wrap: break-word;
    }

    p {
      margin-top: 0;
      margin-bottom: 0.5rem;
    }

    .message p:last-child {
      margin-bottom: 0;
    }

    .message.user {
      align-self: flex-end;
      background-color: var(--chatbot-primary-light-color, #81c784);
      color: white;
      border-bottom-right-radius: 2px;
    }

    .message.assistant {
      align-self: flex-start;
      background-color: #e0e0e0;
      color: #333;
      border-bottom-left-radius: 2px;
    }

    .message.assistant.typing {
      font-style: italic;
      color: #666;
    }
  `,yt([T({type:Array})],Ce.prototype,"messages",2),yt([T({type:String})],Ce.prototype,"typingIndicator",2),yt([gr(".messages")],Ce.prototype,"_messagesContainer",2),Ce=yt([X("chat-body")],Ce);var no=Object.defineProperty,ro=Object.getOwnPropertyDescriptor,bn=(s,e,t,n)=>{for(var r=n>1?void 0:n?ro(e,t):e,i=s.length-1,o;i>=0;i--)(o=s[i])&&(r=(n?o(e,t,r):o(r))||r);return n&&r&&no(e,t,r),r};let xt=class extends q{constructor(){super(...arguments),this.items=[]}render(){return!this.items||this.items.length===0?null:O`
      ${this.items.map(s=>O`
          <button @click=${()=>this._handleClick(s)}>${s}</button>
        `)}
    `}_handleClick(s){this.dispatchEvent(new CustomEvent("quick-reply",{detail:{message:s},bubbles:!0,composed:!0}))}};xt.styles=Y`
    :host {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      padding: 10px 15px;
      justify-content: center;
      border-top: 1px solid #eee;
      background-color: #f0f0f0;
    }

    button {
      background-color: var(--chatbot-primary-light-color, #81c784);
      color: white;
      border: none;
      border-radius: 20px;
      padding: 8px 12px;
      cursor: pointer;
      font-size: 13px;
      transition: background-color 0.3s ease;
    }

    button:hover {
      background-color: var(--chatbot-primary-color, #4caf50);
    }
  `,bn([T({type:Array})],xt.prototype,"items",2),xt=bn([X("quick-replies")],xt);var io=Object.defineProperty,oo=Object.getOwnPropertyDescriptor,kt=(s,e,t,n)=>{for(var r=n>1?void 0:n?oo(e,t):e,i=s.length-1,o;i>=0;i--)(o=s[i])&&(r=(n?o(e,t,r):o(r))||r);return n&&r&&io(e,t,r),r};let Ie=class extends q{constructor(){super(...arguments),this.value="",this.isLoading=!1,this._internalValue=""}willUpdate(s){s.has("value")&&(this._internalValue=this.value)}render(){return O`
      <div class="input-area">
        <input
          type="text"
          .value=${this._internalValue}
          @input=${this._handleInput}
          @keydown=${this._handleKeyDown}
          placeholder="Đặt câu hỏi..."
          ?disabled=${this.isLoading}
        />
        <button @click=${this._handleSubmit} ?disabled=${this.isLoading||!this._internalValue.trim()}>
          ${this.isLoading?"...":"Gửi"}
        </button>
      </div>
    `}_handleInput(s){const e=s.target;this._internalValue=e.value}_handleKeyDown(s){s.key==="Enter"&&!this.isLoading&&this._handleSubmit()}_handleSubmit(){this._internalValue.trim()&&(this.dispatchEvent(new CustomEvent("submit",{detail:{message:this._internalValue},bubbles:!0,composed:!0})),this._internalValue="")}};Ie.styles=Y`
    .input-area {
      display: flex;
      padding: 10px 15px;
      border-top: 1px solid #eee;
      background-color: #fff;
    }

    input {
      flex-grow: 1;
      border: 1px solid #ddd;
      border-radius: 20px;
      padding: 8px 15px;
      font-size: 14px;
      margin-right: 10px;
      outline: none;
    }

    input:focus {
      border-color: var(--chatbot-primary-color, #4caf50);
    }

    button {
      background-color: var(--chatbot-primary-color, #4caf50);
      color: white;
      border: none;
      border-radius: 20px;
      padding: 8px 15px;
      cursor: pointer;
      font-size: 14px;
      transition: background-color 0.3s ease;
    }

    button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
    }
  `,kt([T({type:String})],Ie.prototype,"value",2),kt([T({type:Boolean})],Ie.prototype,"isLoading",2),kt([zs()],Ie.prototype,"_internalValue",2),Ie=kt([X("input-box")],Ie);var ao=Object.defineProperty,lo=Object.getOwnPropertyDescriptor,_n=(s,e,t,n)=>{for(var r=n>1?void 0:n?lo(e,t):e,i=s.length-1,o;i>=0;i--)(o=s[i])&&(r=(n?o(e,t,r):o(r))||r);return n&&r&&ao(e,t,r),r};let wt=class extends q{constructor(){super(...arguments),this.type=null}render(){if(!this.type)return null;const s=this.type==="init"?"Lỗi kết nối phiên chat.":"Không thể gửi tin nhắn.";return O`
      <span>${s}</span>
      <button @click=${this._handleRetry}>Thử lại</button>
    `}_handleRetry(){this.dispatchEvent(new CustomEvent("retry",{bubbles:!0,composed:!0}))}};wt.styles=Y`
    :host {
      display: block;
      padding: 10px 15px;
      background-color: #f8d7da;
      color: #721c24;
      border-top: 1px solid #f5c6cb;
      border-bottom: 1px solid #f5c6cb;
      text-align: center;
      font-size: 14px;
    }

    button {
      background-color: #dc3545;
      color: white;
      border: none;
      border-radius: 5px;
      padding: 5px 10px;
      margin-left: 10px;
      cursor: pointer;
      font-size: 13px;
      transition: background-color 0.3s ease;
    }

    button:hover {
      background-color: #c82333;
    }
  `,_n([T({type:String})],wt.prototype,"type",2),wt=_n([X("chat-error-banner")],wt);var co=Object.defineProperty,ho=Object.getOwnPropertyDescriptor,_e=(s,e,t,n)=>{for(var r=n>1?void 0:n?ho(e,t):e,i=s.length-1,o;i>=0;i--)(o=s[i])&&(r=(n?o(e,t,r):o(r))||r);return n&&r&&co(e,t,r),r};let te=class extends q{constructor(){super(...arguments),this.title="Chatbot",this.messages=[],this.quickReplies=[],this.errorState=null,this.isLoading=!1,this.typingIndicator=null}render(){return O`
      <chat-header .title=${this.title} @minimize=${this._dispatchMinimize}></chat-header>
      <chat-body .messages=${this.messages} .typingIndicator=${this.typingIndicator}></chat-body>
      ${this.errorState?O`<chat-error-banner .type=${this.errorState} @retry=${this._dispatchRetry}></chat-error-banner>`:null}
      <quick-replies .items=${this.quickReplies} @quick-reply=${this._dispatchQuickReply}></quick-replies>
      <input-box .isLoading=${this.isLoading} @submit=${this._dispatchSubmit}></input-box>
    `}_dispatch(s,e={}){this.dispatchEvent(new CustomEvent(s,{detail:e,bubbles:!0,composed:!0}))}_dispatchMinimize(){this._dispatch("minimize")}_dispatchRetry(){this._dispatch("retry")}_dispatchQuickReply(s){this._dispatch("quick-reply",s.detail)}_dispatchSubmit(s){this._dispatch("submit",s.detail)}};te.styles=Zi,_e([T({type:String})],te.prototype,"title",2),_e([T({type:Array})],te.prototype,"messages",2),_e([T({type:Array})],te.prototype,"quickReplies",2),_e([T({type:String})],te.prototype,"errorState",2),_e([T({type:Boolean})],te.prototype,"isLoading",2),_e([T({type:String})],te.prototype,"typingIndicator",2),te=_e([X("chat-box")],te);function po(s,e,t,n){return O`
    <div class="chat-widget-container">
      ${s.isExpanded?O`
            <chat-box
              .title=${s.title}
              .messages=${e.messages}
              .quickReplies=${e.quickReplies}
              .errorState=${e.errorState}
              .isLoading=${e.isLoading}
              .typingIndicator=${n.typingIndicator}
              @minimize=${s.close}
              @quick-reply=${s.handleQuickReply}
              @submit=${s.handleSubmit}
              @retry=${s.retry}
            ></chat-box>
          `:O`
            <chat-launcher @open-chat=${s.open}></chat-launcher>
            ${t.teaserVisible?O`<teaser-message></teaser-message>`:null}
          `}
    </div>
  `}var uo=Object.defineProperty,fo=Object.getOwnPropertyDescriptor,ye=(s,e,t,n)=>{for(var r=n>1?void 0:n?fo(e,t):e,i=s.length-1,o;i>=0;i--)(o=s[i])&&(r=(n?o(e,t,r):o(r))||r);return n&&r&&uo(e,t,r),r};let se=class extends q{constructor(){super(),this.siteId="",this.position="right",this.themeColor="#4caf50",this.title="Chatbot",this.quickRepliesDefault="",this._expanded=!1,this.open=()=>{this._expanded=!0,this.teaser.dismiss()},this.close=()=>{this._expanded=!1},this.handleQuickReply=s=>{this.typingIndicator.start(),this.chatState.handleSubmit(s.detail.message).finally(()=>{this.typingIndicator.stop()})},this.handleSubmit=s=>{this.typingIndicator.start(),this.chatState.handleSubmit(s.detail.message).finally(()=>{this.typingIndicator.stop()})},this.retry=()=>{this.chatState.retry()},this.teaser=new Bi(this),this.typingIndicator=new qi(this),this.chatState=new Hi(this)}get isExpanded(){return this._expanded}connectedCallback(){super.connectedCallback(),br(this),this.chatState.initialize(this.siteId,this.quickRepliesDefault)}render(){return po(this,this.chatState,this.teaser,this.typingIndicator)}};se.styles=Fi,ye([T({type:String})],se.prototype,"siteId",2),ye([T({type:String})],se.prototype,"position",2),ye([T({type:String})],se.prototype,"themeColor",2),ye([T({type:String})],se.prototype,"title",2),ye([T({type:String})],se.prototype,"quickRepliesDefault",2),ye([zs()],se.prototype,"_expanded",2),se=ye([X("chat-widget")],se),customElements.whenDefined("chat-widget").then(()=>{const s=document.createElement("chat-widget");document.body.appendChild(s),console.log("[ChatWidget] Auto-loaded and mounted after definition.")})})();
